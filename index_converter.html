<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioBuffer to WAV </title>
</head>
<body>
    <h1>Convert AudioBuffer to WAV</h1>

    <script src="https://cdn.jsdelivr.net/npm/audiobuffer-to-wav@1.0.0/index.min.js"></script>
    <script>
        var toWav = require('audiobuffer-to-wav');
        var xhr = require('xhr');
        var context = new AudioContext();
        
        // Ajouter le bouton dans la page
        var playButton = document.createElement('button');
        playButton.textContent = "Play Converted Audio";
        playButton.disabled = true; // Désactivé tant que l'audio n'est pas prêt
        document.body.appendChild(playButton);
        
        // Charger et convertir l'audio
        xhr({
          uri: 'audio/the chain solo.mp3',
          responseType: 'arraybuffer'
        }, function (err, body, resp) {
          if (err) throw err;
        
          // Décoder le MP3 en AudioBuffer
          context.decodeAudioData(resp, function (buffer) {
            // Convertir AudioBuffer en WAV
            var wav = toWav(buffer);
        
            // Créer un blob pour l'audio WAV
            var blob = new Blob([wav], { type: 'audio/wav' });
            var url = URL.createObjectURL(blob);
        
            // Créer un élément audio pour jouer le fichier
            var audioElement = new Audio(url);
        
            // Activer le bouton et associer l'événement de lecture
            playButton.disabled = false;
            playButton.addEventListener('click', function () {
              audioElement.play();
            });
          });
        });

    </script>
</body>
</html>
